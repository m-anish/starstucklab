---
import Layout from "../layouts/Layout.astro";
---
<Layout title="Starstuck Lab">
  <h1>Welcome to Starstuck Lab</h1>
  <p>
    “Where science met poetry, had a brief fling with engineering, and now raises mildly disillusioned but talented offspring.”
  </p>
  <p>
    This is the digital home of handmade telescopes, weather contraptions, and cosmic humor. If you came here for meaning,
    you might find it in a solder joint.
  </p>

  <hr />

  <h2>Adjust the Mood</h2>
  <p>Because emotions are best left to machines.</p>

  <!-- The slider will appear right below this -->
  <script type="module">
    import { loadMoodLevel, saveMoodLevel, sliderToLevel } from '/scripts/mood.js';

    window.addEventListener('DOMContentLoaded', () => {
      // create slider (if not already in DOM)
      let slider = document.getElementById('mood-slider');
      if (!slider) {
        slider = document.createElement('input');
        slider.id = 'mood-slider';
        slider.type = 'range';
        slider.min = 0; slider.max = 100; slider.value = 50;
        slider.style.width = '100%';
        document.querySelector('main').insertBefore(slider, document.querySelector('main').firstChild);
      }

      // initialize from storage
      const stored = loadMoodLevel();
      slider.value = (stored - 1) * 25 + 12; // center of band

      slider.addEventListener('input', (e) => {
        const level = sliderToLevel(e.target.value);
        saveMoodLevel(level);
        // fire an event so pages can react
        window.dispatchEvent(new CustomEvent('mood:change', { detail: { level } }));
      });

      // initial dispatch
      window.dispatchEvent(new CustomEvent('mood:change', { detail: { level: sliderToLevel(slider.value) } }));
    });
  </script>

  <p>
    <em>Hint:</em> Slide left for despair, right for delusion.
  </p>
</Layout>
